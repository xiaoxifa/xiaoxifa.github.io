var host="https://api.8xiaoshiwai.cn/";$(function(){function s(){$.ajax({url:host+"script/note/loadAllTags.php",dataType:"json",success:function(t){if(t.state=="success"){$("#tags").html("");$.each(t.data,function(t,s){$("#tags").append("<div class='col-xs-4 col-sm-2'><a><span tagid='"+s.id+"' class='tag'><span>"+s.startTime+"-"+s.endTime+"</span></span></a></div>")});$(".tag").click(function(){$(this).toggleClass("select");var t=[];$("span.tag.select").each(function(){t.push(parseInt($(this).attr("tagid")))});if(t.length>0){$(".del").addClass("enable")}else{$(".del").removeClass("enable")}$("input[name='tags']").val(t.join())})}}})}s();$("#type").change(function(){if($(this).val()=="1"){$(".batch").hide()}else if($(this).val()=="0"){$(".batch").show()}});$(".del").click(function(){if(confirm("确定要删除记录吗？")){$.ajax({type:"post",url:host+"script/tag/del.php",data:{tags:$('input[name="tags"]').val()},dataType:"json",success:function(t){if(t.state!="success"){alert(t.msg)}else{s()}}})}});var a=false;$(".submit").click(function(){if(!a){if($("#type").val()=="0"){if($("#tags").html().length>0){if(!confirm("批量添加将清空所有已存在时段，是否继续操作？")){return}}}a=true;$(".form").ajaxSubmit({url:host+"script/tag/add.php",type:"post",dataType:"json",success:function(t){if(t.state!="success"){alert(t.msg)}else{s()}},complete:function(t,s){a=false}})}})});